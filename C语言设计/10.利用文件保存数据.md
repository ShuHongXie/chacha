### C 文件的有关概念

1. 程序文件：包括源文件(.c)，目标文件(.obj)，可执行文件(.exe)，这种文件是用来存放程序的，以便实现程序的功能。
2. 数据文件：供程序运行时读入内存的数据。
3. 文件：**存储在外部介质上数据的集合**
4. 输入输出流：表示信息从源到目的端的流动。

### 文件名

文件名包括三部分的文件标识

例如：d:\cc\temp\file1.dat

1. 文件路径 d:\cc\temp\
2. 文件名主干 file1
3. 文件后缀 .dat （一般不超过 3 个字母）

### 文件分类

1. **ASCII 文件**，又称 text 文件，一个字节存放一个字符的 ASCII 代码
2. **二进制文件**

### 文件缓冲区

C 语言采用"缓冲文件系统"处理文件，是指系统自动在内存区为程序中每一个正在使用的文件开辟一个**文件缓冲区**，从内存中向磁盘输出数据必须先送到内存中的缓冲区，装满缓冲区后才送到磁盘，如果从磁盘向内存中读入数据，则一次从磁盘文件将一批数据输入到内存缓冲区(充满缓冲区)，然后再从缓冲区逐个地将数据送到程序数据区(给程序变量)，缓冲区大小由各个具体的 C 编译系统确定。

### 文件指针类型

缓冲文件系统中，关键的是文件类型指针，又称**文件指针**，每个被使用的文件都在内存中开辟一个相应的**文件信息区**，用来存放文件的有关信息(如文件名，文件状态，文件当前位置等)。这些信息是保存在一个结构体变量中的，该结构体变量由系统声明存放在头文件"stdio.h"中，叫 FILE，在程序中可以直接使用 FILE 类型定义名词。

```c
// 定义file类型变量
FILE F;
// 定义指向文件型数据的指针变量：
FILE *fp;
```

### 文件的打开和关闭

fopen(文件名，使用文件方式) 失败返回 NULL
fclose(文件指针) 成功返回 0，失败返回 EOF(-1)

```c
FILE *fp;
fp = fopen("a1", "r");
fclose(fp);

```

### 文件读取为什么是按顺序的

文件访问过程：访问磁盘文件是煮个字节进行的，为了知道当前访问到第几自己，系统用**文件读写位置标记**来表示当前所访问的位置，每访问完一个字节后，当前位置标记就指向下一字节。为了知道对文件的访问是否完成，在一个文件的有效字符的后面一字节中，系统自动设置了一个**文件尾**标志，用 EOF 表示,在 stdio 头文件 EOF 被定义为-1

### 文件读写位置标记更改

使用 rewind 函数使文件位置标记指向文件头

1. 重置文件位置标记：rewind(文件类型指针)
2. 移动文件位置标记，改变文件位置标记的位置：fseek(文件类型指针，位移量，起始点)
3. 测定文件位置标记的当前位置(从文件头开始)：ftell(fp)，如果返回-1L 那表示出错，如果函数调用时出错那返回 error

```c
//    起始点        名字          用数字代表
//   文件开始       SEEK_SET          0
//文件位置标记当前位置 SEEK_CUR         1
//    文件开始      SEEK_END          2
fseek(fp, 100, 0); // 将文件位置标记移到离文件头100字节处
fseek(fp, 50L, 1); // 将文件位置标记移到离当前位置后面50字节处
fseek(fp, -10L, 2); // 将文件位置标记从文件末尾处向后退10字节
```

### 字符读取

读：fgetc(fp) 从 fp 指向的文件读入一个字符，成功时带回所读字符，失败时返回 EOF(-1)
写：fputc(ch,fp) 把字符 ch 遇到文件指针变量 fp 所指向的文件中，成功返回输出字符，失败返回 EOF(-1)
检测：feof(in)，判断 in 指向的文件是否读取结束，如果未结束返回 0，结束返回 1

### 字符串读取

读：fgets(str,n,fp), 从 fp 指向的文件读入一个长度为(n-1)的字符串，存放到字符数组 str 中，成功返回地址 str，失败返回 NULL

写：fputs(ch,fp)，把字符 str 写到文件指针变量 fp 所指向的文件中，成功返回 0，否则返回非 0 值

### 文件的格式化读写

fprintf(文件指针，格式字符串，输出表列)；
fscanf(文件指针，格式字符串，输入表列)

```c
// 例如 将整形变量i和实型变量f按照%d和%6.2f的格式输出到fp指向的文件中
fprint(fp, "%d,%6.2f", i ,f);
```

### 用二进制方式读写文件

buffer: 一个地址，对于 fread 来说，是读入数据的存放地址，对 fwrite 来说是输出数据的地址
size: 要读写的字节数
count: 要进行读写多少个 size 字节的数据线
fp：文件型指针

读：fread(buffer,size,count, fp);
写：fwrite(buffer,size,count,fp);

### 系统自定义的文件类型指针

3 个**标准文件**指针

1. stdin(标准输入文件指针)，指向在内存中与键盘相对应的文件信息区，因此用他进行输入就蕴含了**键盘输入**
2. stdout(标准输出文件指针)，指向在内存中与显示器屏幕相对应的文件显示区
3. stderr(标准出错文件指针)，用来输出出错的信息，指向在内存中和显示器屏幕相应的文件显示器，因为，在程序运行出错时的信息就输出到显示器屏幕。
